<h3 *ngIf="farmerName; else noName">Parcelles de {{ farmerName }}</h3>
<ng-template #noName><h3>Parcelles</h3></ng-template>

<div *ngIf="errorMessage" style="margin-top:12px;color:#a94442;border:1px solid #f2dede;padding:8px;">
  {{ errorMessage }}
  <button mat-stroked-button style="margin-left:12px;" (click)="loadParcelles()">RÃ©essayer</button>
</div>

<table *ngIf="!errorMessage" border="1" width="100%" cellpadding="6" style="margin-top:12px;">
  <thead>
    <tr>
      <th>ID</th>
      <th>Nom</th>
      <th>Surface</th>
      <th>Localisation</th>
      <th>Agriculteur</th>
      <th>Type</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let p of parcels">
      <td>{{ p.id }}</td>
      <td>{{ p.nom || ('Parcelle ' + p.id) }}</td>
      <td>{{ p.surface ?? '-' }}</td>
      <td>{{ p.localisation || '-' }}</td>
      <td>
        {{ (p.nom_agriculteur || p.prenom_agriculteur) ? ((p.nom_agriculteur || '') + ' ' + (p.prenom_agriculteur || '')).trim() : (farmerName || '-') }}
      </td>
      <td>{{ p.polygon ? 'Polygon' : 'Point' }}</td>
      <td>
        <button mat-stroked-button color="accent" (click)="openParcel(p.id)" title="Voir">Voir</button>
        <button mat-stroked-button color="warn" (click)="deleteParcelle(p.id)" style="margin-left:8px;">Supprimer</button>
      </td>
    </tr>
  </tbody>
</table>