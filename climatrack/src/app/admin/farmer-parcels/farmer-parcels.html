<div class="container">
  <h2>Parcelles de l'agriculteur</h2>

  <div *ngIf="loading" class="loading">Chargement des parcelles...</div>

  <div *ngIf="error" class="error">{{ error }}</div>

  <div *ngIf="!loading && !error">
    <table mat-table [dataSource]="parcels" class="mat-elevation-z8" style="width: 100%;">

      <!-- Nom Column -->
      <ng-container matColumnDef="nom">
        <th mat-header-cell *matHeaderCellDef>Nom</th>
        <td mat-cell *matCellDef="let p">{{ p.nom || ('Parcelle ' + p.id) }}</td>
      </ng-container>

      <!-- Surface Column -->
      <ng-container matColumnDef="surface">
        <th mat-header-cell *matHeaderCellDef>Surface (m²)</th>
        <td mat-cell *matCellDef="let p">{{ p.surface ?? '-' }}</td>
      </ng-container>

      <!-- Latitude Column -->
      <ng-container matColumnDef="latitude">
        <th mat-header-cell *matHeaderCellDef>Latitude</th>
        <td mat-cell *matCellDef="let p">{{ p.latitude ?? p.lat ?? '-' }}</td>
      </ng-container>

      <!-- Longitude Column -->
      <ng-container matColumnDef="longitude">
        <th mat-header-cell *matHeaderCellDef>Longitude</th>
        <td mat-cell *matCellDef="let p">{{ p.longitude ?? p.lng ?? '-' }}</td>
      </ng-container>

      <!-- Altitude Column -->
      <ng-container matColumnDef="altitude">
        <th mat-header-cell *matHeaderCellDef>Altitude (m)</th>
        <td mat-cell *matCellDef="let p">{{ p.altitude ?? '-' }}</td>
      </ng-container>

      <!-- Actions Column -->
      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef>Actions</th>
        <td mat-cell *matCellDef="let p">
          <button mat-stroked-button color="accent" (click)="voirDetails(p.id)">Voir détails</button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>

    <div *ngIf="parcels.length === 0" class="no-data">Aucune parcelle disponible.</div>
  </div>
</div>
